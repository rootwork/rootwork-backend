{{/* Custom partial defining meta keywords based on categories and tags. */}}
{{ $s := .Site.Params }}
{{ $p := .Params }}

{{- $metaKeywords := slice -}}

{{- with $p.categories -}}
  {{- $metaKeywords = $metaKeywords | append . -}}
{{- end -}}

{{- with $p.tags -}}
  {{- $metaKeywords = $metaKeywords | append . -}}
{{- end -}}

{{- with $p.keywords -}}
  {{- $metaKeywords = $metaKeywords | append . -}}
{{- end -}}

{{/* Add meta keywords based on tags and categories. */}}
{{- $addKeywords := dict
  "accessibility"        "a11y"
  "communications"       "online communications"
  "community"            "communities"
  "Drupal"               "Planet Drupal"
  "frontend development" "frontend"
  "Google Plus"          "Google+"
  "nonprofit technology" "nptech"
  "online advocacy"      "advocacy"
  "open source"          "F/LOSS"
  "social change"        "social justice"
-}}

{{- with $metaKeywords -}}
  {{/* Add keywords defined above. */}}
  {{- range $key, $value := $addKeywords -}}
    {{- if in $metaKeywords $key -}}
      {{- $metaKeywords = $metaKeywords | append $value -}}
    {{- end -}}
  {{- end -}}

  {{/* Comma-delimit and remove empty values. */}}
  {{- $metaKeywords = delimit $metaKeywords ", " -}}
  {{- $metaKeywords = replace $metaKeywords ", , " ", " -}}

{{- end -}}

{{- $keywords := "" -}}
{{- with $s.keywords -}}
  {{- $keywords = delimit $s.keywords "," -}}
{{- end -}}
{{- with $metaKeywords -}}
  {{- $keywords = $metaKeywords -}}
{{- end -}}
{{- with $keywords -}}
  <meta name="keywords" content="{{- $keywords -}}" />
{{- end -}}
