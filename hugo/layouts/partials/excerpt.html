{{/* 1. Adding (visually hidden) page title to 'read more' links.

  2. Restructuring the 'with .Params.thumbnail' section so linters won't
  complain.

  3. Changing the class `pale` to `excerpt_summary`.

  4. Moving the image inside the `excerpt_summary` container.

  5. Adding `summary_wrap` and `more_wrap` div and removing `<br>` tag.
*/}}
<li class="post_item">
  <div class="excerpt">
    <div class="excerpt_header">
      <h3 class="post_link">
        <a href="{{ .Permalink }}" title="{{ .Title }}"
          >{{ .Title | markdownify }}</a
        >
      </h3>
      {{ partial "post-meta" . }}
    </div>

    <div
      class="
        excerpt_footer
        {{ with .Params.thumbnail }}partition{{ end }}
      "
    >
      <div class="excerpt_summary">
        {{- with .Params.thumbnail -}}
          <div class="excerpt_thumbnail">
            {{- partial "image" (dict "file" . "alt" $.Title "type" "thumbnail" "Page" $.Page ) }}
          </div>
        {{- end -}}
        <div class="summary_wrap">
          {{- $summary := truncate 320 .Summary }}
          {{- if .Params.summary }}
            {{- $summary = .Params.summary }}
          {{- else if .Params.abstract }}
            {{ $summary = .Params.abstract }}
          {{- end }}
          {{ if not ( strings.Contains $summary "<p>" ) }}
            <p>{{ $summary | markdownify }}</p>
          {{ else }}
            {{ $summary | markdownify }}
          {{ end }}
        </div>
        <div class="more_wrap">
          {{- $r := T "read_more" }}
          <a
            href="{{ .Permalink }}"
            title="Continue reading '{{ .Title }}'"
            class="excerpt_more button"
            >{{ $r }}<span class="hidden-visually">: {{ .Title }}</span></a
          >
        </div>
      </div>
    </div>
  </div>
</li>
