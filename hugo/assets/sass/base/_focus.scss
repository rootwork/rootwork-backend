// Backwards-compatible :focus-visible
// See https://www.tpgi.com/focus-visible-and-backwards-compatibility/
// and for a full polyfill, https://github.com/WICG/focus-visible

// Inspired by https://fotis.xyz/posts/progressively-enhancing-focus-visible/
// This mixin is not as elegant or flexible, but simpler.

// Usage
//
// SCSS:
//
// a {
//   @include focus(outline, 1px black dotted, none);
// }
//
// CSS:
//
// a:focus {
//   outline: 1px black dotted;
// }
//
// a:focus:not(:focus-visible) {
//   outline: none;
// }
//
// a:focus-visible {
//   outline: 1px black dotted;
// }
//
// If the focus reset is "none", it can be omitted:
// @include focus(outline, 1px black dotted);

@mixin focus($property, $focusStyle, $focusReset: none) {
  &:focus {
    #{$property}: $focusStyle;
  }

  &:focus:not(:focus-visible) {
    #{$property}: $focusReset;
  }

  &:focus-visible {
    #{$property}: $focusStyle;
  }
}

@mixin focus-line($color, $bgcolor-light: #eee, $bgcolor-dark: #002714) {
  &:focus {
    outline: none;
    box-shadow: -6px 0 0 6px $bgcolor-light, -9px 0 0 9px $color;

    html[data-mode='dim'] & {
      box-shadow: -6px 0 0 6px $bgcolor-dark, -9px 0 0 9px $color;
    }

    @media (prefers-color-scheme: dark) {
      box-shadow: -6px 0 0 6px $bgcolor-dark, -9px 0 0 9px $color;
    }
  }

  &:focus:not(:focus-visible) {
    box-shadow: none;

    html[data-mode='dim'] & {
      box-shadow: none;
    }

    @media (prefers-color-scheme: dark) {
      box-shadow: none;
    }
  }

  &:focus-visible {
    outline: none;
    box-shadow: -6px 0 0 6px $bgcolor-light, -9px 0 0 9px $color;

    html[data-mode='dim'] & {
      box-shadow: -6px 0 0 6px $bgcolor-dark, -9px 0 0 9px $color;
    }

    @media (prefers-color-scheme: dark) {
      box-shadow: -6px 0 0 6px $bgcolor-dark, -9px 0 0 9px $color;
    }
  }
}
